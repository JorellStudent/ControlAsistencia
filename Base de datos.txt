-- Tabla Usuarios con los nuevos campos
CREATE TABLE Usuarios (
    IdUsuario INT AUTO_INCREMENT PRIMARY KEY,
    Nombre VARCHAR(100) NOT NULL,
    Apellido VARCHAR(100) NOT NULL,
    Correo VARCHAR(150) NOT NULL UNIQUE,
    Foto VARCHAR(250),
    Sexo VARCHAR(10) NOT NULL, -- "Masculino", "Femenino", "Otro"
    FechaNacimiento DATE NOT NULL,
    Nacionalidad VARCHAR(100) NOT NULL,
    RUT VARCHAR(12) NOT NULL UNIQUE,
    Activo BOOLEAN NOT NULL DEFAULT 1
);

-- Tabla Roles
CREATE TABLE Roles (
    IdRol INT AUTO_INCREMENT PRIMARY KEY,
    NombreRol VARCHAR(50) NOT NULL
);

-- Tabla Credenciales
CREATE TABLE Credenciales (
    IdCredencial INT AUTO_INCREMENT PRIMARY KEY,
    IdUsuario INT NOT NULL,
    NombreUsuario VARCHAR(150) NOT NULL UNIQUE,
    Contrasena VARCHAR(150) NOT NULL,
    IdRol INT NOT NULL,
    FOREIGN KEY (IdUsuario) REFERENCES Usuarios(IdUsuario) ON DELETE CASCADE,
    FOREIGN KEY (IdRol) REFERENCES Roles(IdRol) ON DELETE CASCADE
);

-- Tabla Asistencias
CREATE TABLE Asistencias (
    IdAsistencia INT AUTO_INCREMENT PRIMARY KEY,
    IdUsuario INT NOT NULL,
    Fecha DATE NOT NULL,
    HoraEntrada TIME NOT NULL,
    HoraSalida TIME,
    FOREIGN KEY (IdUsuario) REFERENCES Usuarios(IdUsuario) ON DELETE CASCADE
);

-- Tabla HorariosTrabajo
CREATE TABLE HorariosTrabajo (
    IdHorario INT AUTO_INCREMENT PRIMARY KEY,
    IdUsuario INT NOT NULL,
    HoraEntrada TIME NOT NULL,
    HoraSalida TIME,
    DiaSemana VARCHAR(50) NOT NULL,
    FOREIGN KEY (IdUsuario) REFERENCES Usuarios(IdUsuario) ON DELETE CASCADE
);

-- Tabla Notificaciones
CREATE TABLE Notificaciones (
    IdNotificacion INT AUTO_INCREMENT PRIMARY KEY,
    IdUsuario INT NOT NULL,
    TipoNotificacion VARCHAR(50) NOT NULL,
    FechaEnvio DATETIME NOT NULL,
    Estado BOOLEAN NOT NULL DEFAULT 0,
    FOREIGN KEY (IdUsuario) REFERENCES Usuarios(IdUsuario) ON DELETE CASCADE
);

-- Tabla Auditorias
CREATE TABLE Auditorias (
    IdAuditoria INT AUTO_INCREMENT PRIMARY KEY,
    IdUsuario INT NOT NULL,
    Accion TEXT NOT NULL,
    Fecha DATETIME NOT NULL,
    Hora TIME NOT NULL,
    FOREIGN KEY (IdUsuario) REFERENCES Usuarios(IdUsuario) ON DELETE CASCADE
);

-- Tabla Permisos
CREATE TABLE Permisos (
    IdPermiso INT AUTO_INCREMENT PRIMARY KEY,
    IdUsuario INT NOT NULL,
    FechaInicio DATETIME NOT NULL,
    FechaFin DATETIME NOT NULL,
    TipoPermiso VARCHAR(50) NOT NULL,
    FOREIGN KEY (IdUsuario) REFERENCES Usuarios(IdUsuario) ON DELETE CASCADE
);
